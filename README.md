# gvermSNPs

This is the archived dataset and Rscripts used to generate figures for Agarophyton vermiculophyllum SNP dataset. Author list: Ben A. Flanagan, Stacy A. Krueger-Hadfield, Courtney J. Murren, Chris C. Nice, Allan E. Strand, and Erik E. Sotka

## Software  
angsd and associated programs: http://www.popgen.dk/angsd/index.php  
VCFTOOLS: https://vcftools.github.io/index.html  
bedtools: https://bedtools.readthedocs.io/en/latest/  
SLiM: https://messerlab.org/slim/  

## Data files

1) "599ind.meta.csv"  
Description: all individuals within the RADseq library.  
colnames: ind - name of individuals (pop_number); msats	- the ploidy as determined by microsatellites; visualPloidy & visualPloidy2 - ploidy traits visually determined (e.g., female gametophyte); ploidyfinal - final determination of ploidy from microsatetllites, visual trait or both. Of the 600 individuals that were put into the library, 1 individual did not have reads, and was pulled. 

2) "dips516inds.out"  
Description: list of individuals that are diploid and had reads in >5% of loci. See details in /misc/ProcessBedtoolsMulticov_step1.html

3) "snp_mll_assesment.csv"  
Description: Clonal ramets occur within A. vermiculophyllum populations because thalli can fragment indefinitely. We used microsatellites to identify and remove repeated multilocus genotypes (or MLGs) using R::RClone (Bailleul et al. 2016). If the Psex p-value was greater than 0.05, duplicated MLGs were considered different genets. If the Psex p-value was smaller than 0.05, the duplicated MLGs were considered as ramets (or clones) of the same genet (Arnaud-Haond et al. 2007).  colnames: ind = name of individual (pop_number); mll_id = genotypeID per population; unique_mll = whether or not (1,0) this genotype is unique; pop = population ID

4) "dipsmill.351inds.txt"  
Description: We pulled a single clone haphazardly among the clones (as determined by mll; see above). This left 351 individuals with reads in >20% of loci (see details in misc/ProcessBedtoolsMulticov_step2.html)

5) "dipsmll.351ind.beagle.gz"  
Description: Beagle-formatted file from ANGSD of genotype likelihoods

6) "meta-SNP.pops_edited.V2.csv"  
Description: meta-data for populations used in analyses. Column names: Country = Japan or Non-native; Site Abb = population ID; Latitude; Longitude; lat.name = position of name on map; long.name = position of name on map; pos = indicates the position (1-4; encoded for r::text())

7) "loci.62285.forANGSD.txt"  
Description: SNPs used in analyses. see filtering details in misc/ProcessBedtoolsMulticov_step2.html

8) "dipsmll.351ind.cov"  
Description: individual-level covariance matrix; the output from python code "pcangsd.py", a part of the PCangsd package.

9) "NGSadmix.runs/"  
Description: 10 independent runs for k=2-20 from NGSadmix  

10) "fst/"  
Description: ngsFST output files (by population). from 50K bp sliding window, assessed every 10K steps. Includes pairwise comparisons of every native and non-native population. It also includes the combination of source populations (mngsou) vs other popns. 

11) "ngsLD.stats.500bpBINS.csv"    
Description: linkage disequilibrium estimates (r2) for all pairwise SNPs; estimate of half-decay distance per population averaged across 22 chromosomes. For the 1st file, the column names are pop, chr, and halfdecaydist (bp). For the BINNED file, the column names are pop, chr, halfdecay, halfdecaydist, and dist.LD.is.10perc (=distance until r2 <0.1)  

12) "ConvertGenotypesToVCF.R" and "DiversityEstimatesVCFTOOLS.R"  
Description: The 1st script takes the ANGSD estimates of genotype likelihoods, and converts them to genotype calls. The 2nd script calls VCFTOOLS to create tajimaD, Hexp, Pi and Hobs.

13) "TajimaD.means.csv" 
Description: Tajima D from genotype calls. produced by angsd / VCFTOOLS.  

14) "Hexp.from.allelefreq.means.csv"  
Description: Hexp from genotype calls. produced by angsd / VCFTOOLS.  

15) "Hobs.means.csv"  
Description: Hobs from genotype calls. produced by angsd / VCFTOOLS  

16) "sites.pi.means.csv"  
Description: Diversity (pi) from genotype calls, produced by angsd / VCFTOOLS  

17) "LDanalysis.500bpBINS.rdata"  
Description: The 3rd and 4th columns of these files are the genetic distance in kb and r2 (LD) values for each population x chromosome combination, averaged within 500bp bins. Produced by ngsLD  

18) "simulations" 
Description: SLiM runs  

19) "mast_fst_out.txt.gz"  
Description: Fst data file for the Fst simulation figure, generated by SLiM 

20) "Table-chr.key.txt"  
Description: the "chromosome" key for the scaffolds generated by Dovetail.  

21) "24chr"  
Description: the 24 major scaffolds from the Gracilaria vermiculophylla genome. These 24 scaffolds represent 46.2 Mb, or 96.5% of all data and 96.9% of nuclear DNA (L50/N50 = 10 scaffolds; 2.06 Mb). We note these are not true “chromosomes” until a linkage map is constructed that connects the remaining ~4%.  

### Figure 1: Half-decay curves, visualized  
"R/LDanalysis.makeCurves.500bpBINS.R"  
"output/LDanalysis.makeCurves.500bpBINS.pdf"  
"output/ngsLD.stats.500bpBINS.csv" 

### Figure 2: Empirical vs simulation results - 4 traits (LD, Hobs, D, Pi). ANOVAs are also produced here.   
"R/simulation+empiricalData.R"  
"output/simulation+empirical.pdf"  
"output/ANOVAs.txt"  
"output/TukeyHSD.txt"

### Figure 3: PCA from PCangsd
This code uses principal component analysis (PCA)  
"R/pca.R"  
"output/pca.pdf" 

### Figure 4A-B: admixture (k=7) clusters on map  
This code summarizes the output from 1 run from k=7 as generated by NGSadmix. It is placed onto a map in Japan and non-native range.  
"R/ngsAdmix-points.in.color.globe.R"  
"output/Plot-points.in.color.japan.png"  
"output/Plot-points.in.color.non-native.png" 

### Figure 4C: Assignments of non-native thalli to Japanese populations.  
This code uses principal component analysis (PCA) and linear discriminant analyses (LDA)  
"R/assignment.R"  
"output/assignment-snp.png"  
"output/assignment-snps-details.pdf"

### Figure 5: Pairwise Fst of native sources (mng/sou combined) with the most closely related population along western North America (tmb; top panel), eastern North America (osh; middle panel) and Europe (fdm; lower panel). Lines indicate the 99% outlier loci for comparison purposes only.    
"R/Fstoutlier.mngsou.vs.non.R"  
"output/Fstoutlier.mngsou.vs.non.pdf"  

### Figure 5: Fst simulation figure  
"R/Fstoutlier_simulation.R"  
"output/Fstoutlier_simulation.pdf" 

### Figure S2: Half-decay distance among populations, plotted by region. NOTE: Table 1 ANOVA is generated here  
"R/halfdecay.by.natnon.500bpBINS.R"  
"R/halfdecay.by.chrLength+natnon.500bpBINS.R"  
"output/halfdecay.by.natnon.500bpBINS-bypop.pdf"  
"output/halfdecay.by.chrLength+natnon.500bpBINS.pdf"  
"output/halfdecay.by.chrLength+natnon.500bpBINS.v2.pdf"

### Figure S7: admixture clusters (k=2-16)
"R/ngsAdmix_dips.pretty.k2-16-transformed.R"  
"output/ngsAdmix_dips.pretty.k2-16-transformed.pdf"  

### Figure S8: lnL across k; delta(lnl) and k'' across k. from ngsAdmix  
"R/ngsAdmix-lnl.R"  
"output/ngsAdmix-lnl.pdf"  

### Figure S9: Heatmap - Pairwise Fst of populations that had 10+ individuals  
This code take the ngsFST files (by chromesome and pairwise set of populations), generates a mean fst, and makes a pairwise heatmap of those mean fst values.  
"R/heatmap.R"  
"output/meanfst.csv"  
"output/heatmap.pdf"   

### Figure S10: Genotypic richness for select
"R/simulation_genotypicrichness.R"
"output/simulation_genotypicrichness.pdf"

### MISC  
"ProcessBedtoolsMulticov_step1.html"  
"ProcessBedtoolsMulticov_step2.html"  
These files outline how appropriate loci and samples were identified.  

"SLiM_scripts"  
These are the scripts that generated the SLiM simulations  
